<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crear película</title>
    <style>
        .container {
            padding: 10px;
            border-radius: 8px;
        }

        .button-container {
            position: absolute;
            top: -1300px;
            right: -1220px;
            transform: translate(50%, -50%);
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            font-weight: bold;
        }


        .small {
            font-size: .7em;
        }

        .square {
            width: .7em;
            height: .7em;
            margin: .5em;
            display: inline-block;
        }

        /* Custom dropdown */
        .custom-dropdown {
            position: relative;
            display: inline-block;
            vertical-align: middle;
            margin: 10px;
            /* demo only */
        }

        .custom-dropdown select {
            background-color: #B18FCF;
            color: #fff;
            font-size: inherit;
            padding: .5em;
            padding-right: 2.5em;
            border: 0;
            margin: 0;
            border-radius: 3px;
            text-indent: 0.01px;
            text-overflow: '';
            -webkit-appearance: button;
            /* hide default arrow in chrome OSX */
        }

        .custom-dropdown::before,
        .custom-dropdown::after {
            content: "";
            position: absolute;
            pointer-events: none;
        }

        .custom-dropdown::after {
            /*  Custom dropdown arrow */
            content: "\25BC";
            height: 1em;
            font-size: .625em;
            line-height: 1;
            right: 1.2em;
            top: 50%;
            margin-top: -.5em;
        }

        .custom-dropdown::before {
            /*  Custom dropdown arrow cover */
            width: 2em;
            right: 0;
            top: 0;
            bottom: 0;
            border-radius: 0 3px 3px 0;
        }

        .custom-dropdown select[disabled] {
            color: rgba(0, 0, 0, .3);
        }

        .custom-dropdown select[disabled]::after {
            color: rgba(0, 0, 0, .1);
        }

        .custom-dropdown::before {
            background-color: rgba(0, 0, 0, .15);
        }

        .custom-dropdown::after {
            color: rgba(0, 0, 0, .4);
        }

        .boton {
            padding: 17px 40px;
            border-radius: 10px;
            border: 0;
            background-color: #B18FCF;
            letter-spacing: 1.5px;
            font-size: 15px;
            transition: all 0.3s ease;
            box-shadow: #f402f4;
            color: hsl(0, 0%, 100%);
            cursor: pointer;
        }

        .boton:hover {
            box-shadow: rgb(201, 46, 70) 0px 7px 0px 0px;
        }

        .boton:active {
            background-color: rgb(255, 56, 86);
            /*50, 168, 80*/
            box-shadow: rgb(201, 46, 70) 0px 0px 0px 0px;
            transform: translateY(5px);
            transition: 200ms;
        }

        .highlight-text {
            font-family: 'Arial', sans-serif;
            font-size: 3em;
            color: #B18FCF;
            text-transform: uppercase;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            margin-top: 20px;
            letter-spacing: 2px;
        }

        .input {
            height: 40px;
            border-radius: 8px;
            border: 2px solid #B18FCF;
            outline: none;
            transition: 200ms ease-in;
            padding-left: 1rem;
        }

        .input:focus {
            border-bottom: 4px solid #B18FCF;
            padding-top: 2px;
        }

        .input::placeholder {
            color: #B18FCF;
            opacity: 0.5;
        }

        /* ///  DECORATION CSS ///  */
        .cont_select_center {
            position: absolute;
            left: 50%;
            top: 50%;
            margin-top: -30px;
            margin-left: -150px;
        }

        .cont_heg_50 {
            position: absolute;
            height: 50%;
            left: 0;
            top: 0;
            width: 100%;
            background-color: #fd7b52;
        }

        /* ///  END DECORATION CSS  ///  */

        .icon_select_mate {
            position: absolute;
            top: 20px;
            right: 2%;
            font-size: 16px;
            height: 22px;
            transition: all 275ms;
        }

        .select_mate {
            position: relative;
            font-family: 'Roboto';
            color: #777;
            font-weight: 300;
            background-color: #fff;
            box-shadow: 1px 2px 10px -2px rgba(0, 0, 0, 0.3);
            border-radius: 3px;
            transition: all 375ms ease-in-out;

            /* Oculto el elemento select */
            select {
                position: absolute;
                overflow: hidden;
                height: 0px;
                opacity: 0;
                z-index: -1;
            }
        }

        .cont_list_select_mate {
            position: relative;
            float: left;
            width: 100%;
        }

        .cont_select_int {
            position: absolute;
            left: 0px;
            top: 0px;
            z-index: 999;
            overflow: hidden;
            height: 0px;
            width: 100%;
            background-color: #fff;
            padding: 0px;
            margin-bottom: 0px;
            margin-top: 0px;
            border-radius: 0px 0px 3px 3px;
            box-shadow: 1px 4px 10px -2px rgba(0, 0, 0, 0.2);
            transition: all 375ms ease-in-out;

            li {
                position: relative;
                float: left;
                width: 96%;
                border-bottom: 1px solid #E0E0E0;
                background-color: #F5F5F5;
                list-style-type: none;
                padding: 10px 2%;
                margin: 0px;
                transition: all 275ms ease-in-out;
                display: block;
                cursor: pointer;

                &:last-child {
                    border-radius: 3px;
                    border-bottom: 0px;

                }

                &:hover {
                    background-color: #EEEEEE;
                }
            }

            .active {
                background-color: #EEEEEE;
            }

        }

        /* etiqueta <p> con la opcion selecionada  */
        .selecionado_opcion {
            padding: 20px 2%;
            width: 96%;
            display: block;
            margin: 0px;
            cursor: pointer;
        }

        .custom-dropdown {
            position: relative;
            display: inline-block;
        }

        .dropdown-button {
            background-color: #f9f9f9;
            border: 1px solid #ccc;
            padding: 10px;
            cursor: pointer;
            width: 100%;
            text-align: left;
        }

        .dropdown-content {
            display: none;
            position: absolute;
            background-color: #f9f9f9;
            box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);
            padding: 12px 16px;
            z-index: 1;
        }

        .dropdown-content label {
            display: block;
            margin-bottom: 8px;
        }

        .custom-dropdown.show .dropdown-content {
            display: block;
        }
    </style>
</head>

<body>
    <h1 class="highlight-text" style="text-align: center;">Nueva Película</h1>
    <div class="container" style="background-color:#ced4da ;">
        <div class="row">
            <div class="col-6">
                <form id="peliculaForm" action="/pelicula/c" method="post" enctype="multipart/form-data">
                    <div class="form-group">
                        <label for="titulo">Título</label>
                        <input class="form-control" name="titulo" required minlength="2" maxlength="30" type="text"
                            placeholder="Nombre de la película">
                    </div>
                    <div class="form-group">
                        <label for="categoria">Categoría</label>
                        <div class="custom-dropdown form-control" id="custom-dropdown">
                            <button class="dropdown-button">Seleccione categorías</button>
                            <div class="dropdown-content">
                                <div th:each="categoria : ${categorias}">
                                    <label>
                                        <input type="checkbox" name="categoria[]" th:value="${categoria.idCategoria}">
                                        <span th:text="${categoria.nombre}"></span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="clasificacion">Clasificación</label>
                        <br>
                        <div class="select_mate form-control" id="clasificacion" data-mate-select="active">
                            <select name="clasificacion" onchange="" onclick="return false;" id="">
                                <option value="3">Apto para todos</option>
                                <option value="7">Para 7 años</option>
                                <option value="PG-13">Mayores de 12</option>
                                <option value="16">Mayores de 16</option>
                                <option value="R">Mayores de 18</option>
                            </select>
                            <p class="selecionado_opcion" onclick="open_select(this)"></p><span
                                onclick="open_select(this)" class="icon_select_mate"><svg fill="#000000" height="24"
                                    viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M7.41 7.84L12 12.42l4.59-4.58L18 9.25l-6 6-6-6z" />
                                    <path d="M0-.75h24v24H0z" fill="none" />
                                </svg></span>
                            <div class="cont_list_select_mate">
                                <ul class="cont_select_int"> </ul>
                            </div>
                        </div>

                    </div>
                    <div class="form-group">
                        <label for="duracion">Duración</label>
                        <input class="form-control" name="duracion" required min="10" max="500" type="number"
                            placeholder="Duración de la película">
                    </div>
                    <div class="form-group">
                        <label for="plataforma">Plataforma</label>
                        <input type="text" class="form-control" name="plataforma" required
                            placeholder="Plataforma de la película">
                    </div>
                    <div class="form-group">
                        <label for="puntuacion">Puntuacion</label>
                        <input class="form-control" name="puntuacion" required min="0" max="10" type="number"
                            placeholder="Puntuacion de la pelicula">
                    </div>
            </div>
            <div class="col-md-6">
                <div class="form-group">
                    <label for="estado">Estado</label>
                    <br>
                    <div class="select_mate form-control" id="estado" data-mate-select="active">
                        <select name="estado" onchange="" onclick="return false;" id="">
                            <option value="Released">Disponible</option>
                            <option value="Unreleased">No Disponible</option>
                        </select>
                        <p class="selecionado_opcion" onclick="open_select(this)"></p><span onclick="open_select(this)"
                            class="icon_select_mate"><svg fill="#000000" height="24" viewBox="0 0 24 24" width="24"
                                xmlns="http://www.w3.org/2000/svg">
                                <path d="M7.41 7.84L12 12.42l4.59-4.58L18 9.25l-6 6-6-6z" />
                                <path d="M0-.75h24v24H0z" fill="none" />
                            </svg></span>
                        <div class="cont_list_select_mate">
                            <ul class="cont_select_int"> </ul>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="sinopsis">Sinopsis</label>
                    <textarea class="form-control" required minlength="10" maxlength="500" name="sinopsis"
                        placeholder="Sinopsis de la película" rows="5" cols="4"></textarea>
                </div>
                <div class="form-group">
                    <label for="fecha_lanzamiento">Fecha de salida</label>
                    <input type="date" class="form-control" required id="fecha_lanzamiento" name="fechaLanzamiento"
                        placeholder="Fecha de lanzamiento">
                </div>
                <div class="form-group">
                    <label for="imagen">Imagen</label>
                    <input class="form-control" name="imagen" required id="imagen" type="file"
                        onchange="previewImage(event)">
                    <div id="image-preview-container" style="margin-top: 10px;"></div>
                </div>
                <div class="form-group">
                    <label for="trailer">Tráiler</label>
                    <input class="form-control" name="trailer" required type="text" placeholder="URL del tráiler">
                </div>
                <div class="form-group">
                    <label for="url">URL</label>
                    <input class="form-control" name="url" required type="text"
                        placeholder="URL de compra de la película">
                </div>
            </div>
        </div>
        <div class="form-group">
            <button type="submit" class="boton float-end">Crear</button>
        </div>
        </form>
        <div class="form-group">
            <button class="boton" onclick="window.location.href='/pelicula/r'">Volver</button>
        </div>
    </div>


</body>
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script>
    // Función para previsualizar la imagen seleccionada
    function previewImage(event) {
        var input = event.target;

        if (input.files && input.files[0]) {
            var reader = new FileReader();

            reader.onload = function (e) {
                var imagePreviewContainer = document.getElementById('image-preview-container');
                imagePreviewContainer.innerHTML = '<img src="' + e.target.result + '" class="img-fluid" alt="Vista previa de la imagen">';
            };

            reader.readAsDataURL(input.files[0]); // Lee el contenido de la imagen como una URL
        }
    }
    window.onload = function () {
        crear_select();
    }

    function isMobileDevice() {
        return (typeof window.orientation !== "undefined") || (navigator.userAgent.indexOf('IEMobile') !== -1);
    };


    var li = new Array();
    function crear_select() {
        var div_cont_select = document.querySelectorAll("[data-mate-select='active']");
        var select_ = '';
        for (var e = 0; e < div_cont_select.length; e++) {
            div_cont_select[e].setAttribute('data-indx-select', e);
            div_cont_select[e].setAttribute('data-selec-open', 'false');
            var ul_cont = document.querySelectorAll("[data-indx-select='" + e + "'] > .cont_list_select_mate > ul");
            select_ = document.querySelectorAll("[data-indx-select='" + e + "'] >select")[0];
            if (isMobileDevice()) {
                select_.addEventListener('change', function () {
                    _select_option(select_.selectedIndex, e);
                });
            }
            var select_optiones = select_.options;
            document.querySelectorAll("[data-indx-select='" + e + "']  > .selecionado_opcion ")[0].setAttribute('data-n-select', e);
            document.querySelectorAll("[data-indx-select='" + e + "']  > .icon_select_mate ")[0].setAttribute('data-n-select', e);
            for (var i = 0; i < select_optiones.length; i++) {
                li[i] = document.createElement('li');
                if (select_optiones[i].selected == true || select_.value == select_optiones[i].innerHTML) {
                    li[i].className = 'active';
                    document.querySelector("[data-indx-select='" + e + "']  > .selecionado_opcion ").innerHTML = select_optiones[i].innerHTML;
                };
                li[i].setAttribute('data-index', i);
                li[i].setAttribute('data-selec-index', e);
                // funcion click al selecionar 
                li[i].addEventListener('click', function () { _select_option(this.getAttribute('data-index'), this.getAttribute('data-selec-index')); });

                li[i].innerHTML = select_optiones[i].innerHTML;
                ul_cont[0].appendChild(li[i]);

            }; // Fin For select_optiones
        }; // fin for divs_cont_select
    } // Fin Function 



    var cont_slc = 0;
    function open_select(idx) {
        var idx1 = idx.getAttribute('data-n-select');
        var ul_cont_li = document.querySelectorAll("[data-indx-select='" + idx1 + "'] .cont_select_int > li");
        var hg = 0;
        var slect_open = document.querySelectorAll("[data-indx-select='" + idx1 + "']")[0].getAttribute('data-selec-open');
        var slect_element_open = document.querySelectorAll("[data-indx-select='" + idx1 + "'] select")[0];
        if (isMobileDevice()) {
            if (window.document.createEvent) { // All
                var evt = window.document.createEvent("MouseEvents");
                evt.initMouseEvent("mousedown", false, true, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);
                slect_element_open.dispatchEvent(evt);
            } else if (slect_element_open.fireEvent) { // IE
                slect_element_open.fireEvent("onmousedown");
            } else {
                slect_element_open.click();
            }
        } else {


            for (var i = 0; i < ul_cont_li.length; i++) {
                hg += ul_cont_li[i].offsetHeight;
            };
            if (slect_open == 'false') {
                document.querySelectorAll("[data-indx-select='" + idx1 + "']")[0].setAttribute('data-selec-open', 'true');
                document.querySelectorAll("[data-indx-select='" + idx1 + "'] > .cont_list_select_mate > ul")[0].style.height = hg + "px";
                document.querySelectorAll("[data-indx-select='" + idx1 + "'] > .icon_select_mate")[0].style.transform = 'rotate(180deg)';
            } else {
                document.querySelectorAll("[data-indx-select='" + idx1 + "']")[0].setAttribute('data-selec-open', 'false');
                document.querySelectorAll("[data-indx-select='" + idx1 + "'] > .icon_select_mate")[0].style.transform = 'rotate(0deg)';
                document.querySelectorAll("[data-indx-select='" + idx1 + "'] > .cont_list_select_mate > ul")[0].style.height = "0px";
            }
        }

    } // fin function open_select

    function salir_select(indx) {
        var select_ = document.querySelectorAll("[data-indx-select='" + indx + "'] > select")[0];
        document.querySelectorAll("[data-indx-select='" + indx + "'] > .cont_list_select_mate > ul")[0].style.height = "0px";
        document.querySelector("[data-indx-select='" + indx + "'] > .icon_select_mate").style.transform = 'rotate(0deg)';
        document.querySelectorAll("[data-indx-select='" + indx + "']")[0].setAttribute('data-selec-open', 'false');
    }


    function _select_option(indx, selc) {
        if (isMobileDevice()) {
            selc = selc - 1;
        }
        var select_ = document.querySelectorAll("[data-indx-select='" + selc + "'] > select")[0];

        var li_s = document.querySelectorAll("[data-indx-select='" + selc + "'] .cont_select_int > li");
        var p_act = document.querySelectorAll("[data-indx-select='" + selc + "'] > .selecionado_opcion")[0].innerHTML = li_s[indx].innerHTML;
        var select_optiones = document.querySelectorAll("[data-indx-select='" + selc + "'] > select > option");
        for (var i = 0; i < li_s.length; i++) {
            if (li_s[i].className == 'active') {
                li_s[i].className = '';
            };
            li_s[indx].className = 'active';

        };
        select_optiones[indx].selected = true;
        select_.selectedIndex = indx;
        select_.onchange();
        salir_select(selc);
    }
    document.addEventListener('DOMContentLoaded', (event) => {
        const dropdown = document.getElementById('custom-dropdown');
        const button = dropdown.querySelector('.dropdown-button');

        button.addEventListener('click', () => {
            dropdown.classList.toggle('show');
        });

        // Close the dropdown if the user clicks outside of it
        window.addEventListener('click', (event) => {
            if (!dropdown.contains(event.target)) {
                dropdown.classList.remove('show');
            }
        });
    });


</script>

</html>